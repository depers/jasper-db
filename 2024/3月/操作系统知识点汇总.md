> 面试/操作系统

> 对操作系统中常问考点的总结和汇总。

![](../../assert/Linux操作系统.jpg)

# 操作系统

## 进程与线程

1. 区别和联系

    进程是指一个程序在计算机上的一次执行过程。每个进程都有自己独立的地址空间、资源和状态，并且可以独立地执行任务。进程是操作系统进行**资源分配和调度的基本单位**。
    线程是进程内部的一个执行单元，是操作系统能够进行**运算调度的最小单位**。每个线程都有自己的栈、程序计数器和局部变量等，但它与同一进程内的其他线程共享进程的地址空间、资源和状态。线程可以并发执行，提高了程序的并发性和效率。

    **进程和线程的区别如下：**

    1. 地址空间：每个进程都有自己独立的地址空间，而线程共享所属进程的地址空间。
    2. 资源分配：进程是操作系统进行资源分配的基本单位，线程共享所属进程的资源。
    3. 调度：进程是操作系统进行调度的基本单位，线程可以并发执行，由操作系统根据调度算法进行调度。
    4. 独立性：进程是独立的执行实体，而线程是进程内部的执行单元，线程之间相对独立。
    5. 创建和销毁：创建和销毁进程的开销较大，而创建和销毁线程的开销较小。

    **进程和线程之间也有联系：**
    1.  一个进程可以包含多个线程，它们共享进程的资源和状态。
    2.  线程是进程的执行单元，线程的执行依赖于进程的存在。
    3.  进程和线程都可以进行通信和同步。

    在实际应用中，通常根据需要将一个进程划分为多个线程，以提高程序的并发性和效率。例如，在一个 Web 服务器中，可以创建多个线程来处理不同的客户端请求，从而提高服务器的并发处理能力。

2. 线程调度

    线程调度是操作系统的核心功能之一，它决定了**在多线程环境下哪个线程可以获得 CPU 资源并执行**。线程调度的目标是**在多个线程之间公平地分配 CPU 时间**，以确保系统的整体性能和响应能力。

    常见的线程调度算法包括**先来先服务（FCFS）调度算法**、**短作业优先（SJF）调度算法**、**优先级调度算法**和**轮询调度算法**等。不同的调度算法适用于不同的场景，操作系统可以根据线程的特性和应用程序的需求选择合适的调度算法。

3. 线程切换的步骤

    线程切换是操作系统在多个线程之间进行上下文切换的过程。当一个线程执行一段时间后，操作系统会暂停该线程的执行，并将其状态保存到线程的上下文结构中，然后选择另一个线程继续执行。线程切换的步骤通常包括以下几个阶段：

    * **保存当前线程的上下文**：操作系统会将当前线程的寄存器状态、程序计数器、栈指针等信息保存到线程的上下文结构中。上下文结构是操作系统用于保存线程执行状态的一种数据结构。
    * **选择下一个要执行的线程**：操作系统根据调度算法选择下一个要执行的线程。调度算法可以基于优先级、时间片轮询、先来先服务等策略来决定线程的执行顺序。
    * **恢复下一个线程的上下文**：操作系统将选择的下一个线程的上下文从线程的上下文结构中加载到处理器的寄存器中，恢复线程的执行状态。
    * **开始执行下一个线程**：处理器根据恢复的上下文开始执行下一个线程的指令，直到该线程被暂停或终止。
        线程切换的过程是由操作系统的内核来管理和执行的，对于应用程序来说是透明的。线程切换的目的是实现并发执行，提高系统的整体性能和响应能力。

4. Linux下的IPC

    在 Linux 操作系统中，IPC（Inter-Process Communication，进程间通信）是指不同进程之间进行数据交换和同步的机制。以下是几种常见的 Linux 下的 IPC 方式：

    1. 管道（Pipe）：管道是一种简单的 IPC 机制，它允许进程之间通过一个共享的缓冲区进行数据交换。一个进程将数据写入管道的一端，另一个进程可以从管道的另一端读取数据。
    2. 消息队列（Message Queue）：消息队列是一种用于进程间异步通信的机制。进程可以将消息放入队列中，另一个进程可以从队列中读取消息。消息队列提供了一种可靠的、有序的数据交换方式。
    3. 信号量（Semaphore）：信号量用于实现进程间的同步。它可以用于控制对共享资源的访问，确保在任何给定时间只有一个进程可以访问该资源。
    4. 共享内存（Shared Memory）：共享内存是一种允许进程之间共享一块内存区域的机制。多个进程可以同时访问共享内存，从而实现高效的数据交换和共享。
    5. 套接字（Socket）：套接字是一种用于网络通信的 IPC 机制。它允许进程通过网络在不同的主机之间进行通信。

5. 协程

    协程（Coroutine）是一种轻量级的线程，它允许一个函数在执行过程中暂停和恢复，而不需要操作系统进行线程的切换。协程可以在单线程环境下实现并发执行，提高程序的性能和响应能力。

## Linux的常用命令

1. awk

    awk 命令是 Linux 系统中的一个**文本处理工具**，用于对文本文件进行数据处理和分析。它具有强大的编程能力，可以执行复杂的文本处理任务。
    awk 命令的基本语法如下：`awk [options] 'script' input_files`

    其中，options是可选的命令行参数，用于指定 awk 的行为；script是一个用 awk 语言编写的脚本，用于指定数据处理的规则；input_files是要处理的输入文件，可以是一个或多个文件。

    awk 语言的基本结构包括：

    * 变量：用于存储数据，可以通过$符号来引用变量。
    * 函数：用于执行特定的操作，例如字符串处理、数学计算等。
    * 条件语句：用于根据条件执行不同的操作，例如if-else语句、while循环等。
    * 输出语句：用于将处理结果输出到控制台或文件。

    以下是一个简单的 awk 命令示例，用于统计一个文本文件中的行数：
    ```shell
    awk '{print NR}' file.txt
    ```

    在这个示例中，NR是 awk 内置变量，表示当前行的行号。print函数用于输出变量的值。

2. top

    top命令是 Linux 系统中的一个性能监控工具，用于实时显示系统的进程信息、资源使用情况等。它提供了一个界面，显示了系统中运行的进程的相关信息，包括进程 ID、用户名、CPU 使用率、内存使用率等。

    你可以使用以下命令在终端中运行top命令：`top`

    在top命令的输出中，你可以看到以下主要部分：

    1. 表头信息：显示了一些列的标题，包括进程 ID（PID）、用户名（User）、CPU 使用率（%CPU）、内存使用率（%MEM）等。
    2. 进程列表：显示了系统中正在运行的进程的信息，按照 CPU 使用率降序排列。
    3. CPU 信息：显示了 CPU 的总体使用情况，包括用户进程、系统进程和空闲时间的百分比。
    4. 内存信息：显示了内存的总体使用情况，包括物理内存、交换空间的使用量和空闲量。
    5. 其他信息：还显示了其他系统信息，如进程状态、负载平均值等。

    你可以使用键盘上的按键来与top命令进行交互，执行一些操作，例如：

    * `q`：退出top命令。
    * `h`：显示帮助信息。
    * `空格`：立即刷新显示。
    * `1`：显示每个 CPU 核心的使用情况。
    * `M`：按照内存使用率排序进程。

    * `P`：按照 CPU 使用率排序进程。

    通过使用top命令，你可以实时监控系统的性能，并识别出占用资源最多的进程。这对于性能调优、故障排除和资源管理非常有帮助。

3. netstat

    netstat命令是 Linux 系统中的一个网络监控工具，用于显示网络连接、路由表、网络接口等信息。它提供了关于系统网络活动的详细信息。

4. grep

    grep命令是 Linux 系统中的一个文本搜索工具，用于在文本文件或标准输入中查找匹配指定模式的字符串。

5. less

    grep命令是 Linux 系统中的一个文本搜索工具，用于在文本文件或标准输入中查找匹配指定模式的字符串。

6. tail

    tail命令是 Linux 系统中的一个文件查看工具，用于显示文件的末尾部分。