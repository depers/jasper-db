| title                              | tags            | background                                                   | auther | isSlow |
| ---------------------------------- | --------------- | ------------------------------------------------------------ | ------ | ------ |
| 秒杀系统设计的要点（二）分布式扩展 | Spring Boot/Web | 这篇文章是”秒杀系统设计的要点（一）性能压测“第二篇文章，这里主要讨论服务器端的水平扩展和其带来的分布式会话的解决方案。 | depers | true   |

# 背景

在上一节”[秒杀系统设计的要点（一）性能压测](http://www.bravedawn.cn/details.html?aid=8507)“中，我们对现有的实现进行了性能压测，并通过修改Tomcat配置对应用进行了优化，但是单机部署的应用由于受系统资源限制、网络带宽增加和数据库性能瓶颈的影响，无法进一步提升系统的性能。在本节中我们准备通过分布式扩展的方式来解决这个问题。

# 使用Nginx反向代理进行负载均衡

## 1. 使用OpenResty

**Nginx (engine x)** 是一款轻量级的 Web 服务器 、反向代理服务器及电子邮件（IMAP/POP3）代理服务器。

**OpenResty** 是一个基于 Nginx 的 Web 服务器平台，它在 Nginx 的基础上添加了许多扩展和功能。OpenResty 提供了一个灵活和强大的环境，可以用于构建高性能的 Web 应用和服务。默认集成了Lua开发环境，使得Nginx可以作为一个Web server来使用。OpenResty提供了对MySQL、Memcached和Redis等组件使用支持。

关于OpenResty安装教程大家可以参考官网。

## 2. 配置Nginx反向代理

```nginx
upstream miaosha {
	server 192.168.1.173:8080;
	server 192.168.1.174:8080;
	server 192.168.1.175:8080;
}

server {
	listen 80;
	server_name www.miaosha.com;

	location / {
		proxy_pass http://miaosha;
	}
}
```

## 3.Nginx高性能的原因



# 分布式会话的管理



# 使用Redis实现分布式会话的存储





# 多级缓存

# 页面静态化

# 缓存库存

# 事务型消息保证最终一致性

# 流量削峰

# 防刷限流

# 参考文章

* [聚焦Java性能优化 打造亿级流量秒杀系统](https://coding.imooc.com/class/338.html)